<Window x:Class="CoverageAnalyzerGUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CoverageAnalyzerGUI"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:avalonDock="http://schemas.xceed.com/wpf/xaml/avalondock"
        xmlns:avalondockthemes="clr-namespace:AvalonDock.Themes;assembly=AvalonDock.Themes.VS2013"
        mc:Ignorable="d"
        Title="Coverage Analyzer - Visual Studio Style (.NET Assembly Integration)" Height="900" Width="1400">
    
    <Window.InputBindings>
        <KeyBinding Key="OemTilde" Modifiers="Ctrl" Command="{Binding ToggleOutputCommand}"/>
    </Window.InputBindings>
    
    <Window.Resources>
        <!-- Light Theme Resources (Default) -->
        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ControlBackgroundBrush" Color="#F0F0F0"/>
        <SolidColorBrush x:Key="MenuBackgroundBrush" Color="#F6F6F6"/>
        <SolidColorBrush x:Key="TextForegroundBrush" Color="#000000"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E5E5E5"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#007ACC"/>

        <!-- TreeView Item Template for HVP Hierarchy with Checkboxes -->
        <HierarchicalDataTemplate x:Key="HvpNodeTemplate" ItemsSource="{Binding Children}">
            <StackPanel Orientation="Horizontal">
                <CheckBox Name="NodeCheckBox" 
                          IsChecked="{Binding IsSelected}"
                          VerticalAlignment="Center" 
                          Margin="0,0,5,0"
                          Checked="TreeViewItem_Checked" 
                          Unchecked="TreeViewItem_Unchecked"/>
                <TextBlock Text="{Binding Name}" 
                           Width="60"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"
                           TextTrimming="CharacterEllipsis"/>
                <TextBlock Text="{Binding CoveragePercentage, StringFormat='{}{0:F1}%'}" 
                           Width="80"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"/>
                <TextBlock Text="{Binding GroupType}" 
                           Width="120"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"
                           TextTrimming="CharacterEllipsis"/>
                <TextBlock Width="100"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"
                           TextTrimming="CharacterEllipsis">
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0}/{1}">
                            <Binding Path="LinesCovered"/>
                            <Binding Path="TotalLines"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
                <TextBlock Text="{Binding TestInfo}" 
                           Width="100"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"
                           TextTrimming="CharacterEllipsis"/>
                <TextBlock Text="{Binding JiraNumber}" 
                           Width="80"
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"
                           TextTrimming="CharacterEllipsis"/>
            </StackPanel>
        </HierarchicalDataTemplate>
        
        <!-- TreeView Item Template for Stats with only Name and Jira# -->
        <HierarchicalDataTemplate x:Key="StatsNodeTemplate" ItemsSource="{Binding Children}">
            <StackPanel Orientation="Horizontal">
                <CheckBox Name="NodeCheckBox" 
                          IsChecked="{Binding IsSelected}"
                          VerticalAlignment="Center" 
                          Margin="0,0,10,0"
                          Checked="TreeViewItem_Checked" 
                          Unchecked="TreeViewItem_Unchecked"/>
                <TextBlock Text="{Binding Name}" 
                           VerticalAlignment="Center" 
                           Margin="0,0,15,0"
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"/>
                <TextBlock Text="{Binding JiraNumber}" 
                           VerticalAlignment="Center" 
                           Foreground="{DynamicResource TextForegroundBrush}"
                           FontSize="11"/>
            </StackPanel>
        </HierarchicalDataTemplate>
    </Window.Resources>
    
    <!-- Main Layout Container with AvalonDock -->
    <Grid Background="{DynamicResource WindowBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Menu and Toolbar -->
            <RowDefinition Height="*"/>    <!-- AvalonDock Area -->
            <RowDefinition Height="Auto"/> <!-- Status Bar -->
        </Grid.RowDefinitions>
        
        <!-- Top Area: Menu and Toolbar -->
        <StackPanel Grid.Row="0">

            <!-- Menu Bar -->
            <Menu Background="{DynamicResource MenuBackgroundBrush}" 
                  BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1" 
                  Foreground="{DynamicResource TextForegroundBrush}">
                <MenuItem Header="_File">
                    <MenuItem Header="_New Project..." Click="NewProject_Click"/>
                    <MenuItem Header="_Open Project..." Click="OpenProject_Click"/>
                    <Separator/>
                    <MenuItem Header="_Load Coverage Data" Click="LoadCoverageData_Click"/>
                    <Separator/>
                    <MenuItem Header="_Save" Click="Save_Click"/>
                    <MenuItem Header="Save _All" Click="SaveAll_Click"/>
                    <Separator/>
                    <MenuItem Header="E_xit" Click="Exit_Click"/>
                </MenuItem>
                <MenuItem Header="_Edit">
                    <MenuItem Header="_Undo" Click="Undo_Click"/>
                    <MenuItem Header="_Redo" Click="Redo_Click"/>
                    <Separator/>
                    <MenuItem Header="Cu_t" Click="Cut_Click"/>
                    <MenuItem Header="_Copy" Click="Copy_Click"/>
                    <MenuItem Header="_Paste" Click="Paste_Click"/>
                    <Separator/>
                    <MenuItem Header="Multi-_Selection">
                        <MenuItem Header="_Clear All Selections" Click="ClearAllSelections_Click"/>
                        <MenuItem Header="Select _All" Click="SelectAll_Click"/>
                        <MenuItem Header="Export _Selected Nodes" Click="ExportSelectedNodes_Click"/>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="_View">
                    <MenuItem Header="_Solution Explorer" Click="ToggleSolutionExplorer_Click"/>
                    <MenuItem Header="_Output" Click="ToggleOutput_Click"/>
                    <MenuItem Header="_Error List" Click="ToggleErrorList_Click"/>
                    <Separator/>
                    <MenuItem Header="_Reset Layout" Click="ResetLayout_Click"/>
                    <Separator/>
                    <MenuItem Header="_Theme">
                        <MenuItem Header="_Light Theme" Click="SetLightTheme_Click"/>
                        <MenuItem Header="_Dark Theme" Click="SetDarkTheme_Click"/>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="_Tools">
                    <MenuItem Header="_Coverage Analysis" Click="RunCoverageAnalysis_Click"/>
                    <MenuItem Header="_Reload Project" Click="TestHvpTreeView_Click"/>
                    <Separator/>
                    <MenuItem Header="_HTTP Authentication..." Click="HttpAuthentication_Click"/>
                    <Separator/>
                    <MenuItem Header="Create _Jira" Click="CreateJira_Click"/>
                    <MenuItem Header="Add to _Waiver" Click="AddToWaiver_Click"/>
                    <Separator/>
                    <MenuItem Header="_Options..." Click="Options_Click"/>
                </MenuItem>
                <MenuItem Header="_Help">
                    <MenuItem Header="_About" Click="About_Click"/>
                </MenuItem>
            </Menu>

            <!-- Toolbar -->
            <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                <ToolBarTray Background="{DynamicResource ControlBackgroundBrush}">
                    <ToolBar Background="{DynamicResource ControlBackgroundBrush}" 
                             Foreground="{DynamicResource TextForegroundBrush}">
                        <Button Click="NewProject_Click" ToolTip="New Project" 
                                Content="📄" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                        <Button Click="OpenProject_Click" ToolTip="Open Project" 
                                Content="📁" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                        <Button Click="Save_Click" ToolTip="Save" 
                                Content="💾" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                        <Separator/>
                        <Button Click="RunCoverageAnalysis_Click" ToolTip="Run Coverage Analysis" 
                                Content="▶️" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                        <Separator/>
                        <Button Click="CreateJira_Click" ToolTip="Create Jira" 
                                Content="🎫" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                        <Button Click="AddToWaiver_Click" ToolTip="Add to Waiver" 
                                Content="📋" Padding="6,4" FontSize="14" Width="32" Height="28"/>
                    </ToolBar>
                </ToolBarTray>
            </Border>
        </StackPanel>

        <!-- Main Docking Area - AvalonDock Professional -->
        <avalonDock:DockingManager Grid.Row="1" Name="DockingManager" 
                                  Background="{DynamicResource WindowBackgroundBrush}"
                                  BorderBrush="{DynamicResource BorderBrush}"
                                  BorderThickness="1">
            
            <!-- Layout Root -->
            <avalonDock:LayoutRoot>
                <avalonDock:LayoutPanel Orientation="Vertical">
                    
                    <!-- Top section: Solution Explorer + Content -->
                    <avalonDock:LayoutPanel Orientation="Horizontal">
                    
                    <!-- Left Dock Panel: Solution Explorer -->
                    <avalonDock:LayoutAnchorablePaneGroup DockWidth="650">
                        <avalonDock:LayoutAnchorablePane>
                            <avalonDock:LayoutAnchorable ContentId="SolutionExplorer" Title="Solution Explorer" 
                                                         CanHide="True" CanClose="False" CanFloat="True">
                                <!-- Solution Explorer Content -->
                                <TabControl Name="ExplorerTabControl" TabStripPlacement="Top" 
                                           Background="{DynamicResource ControlBackgroundBrush}" 
                                           BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                    
                                    <!-- HVP Tab -->
                                    <TabItem Header="Hvp" IsSelected="True">
                                        <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Column Headers -->
                                            <Border Grid.Row="0" Background="{DynamicResource MenuBackgroundBrush}" 
                                                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1"
                                                    Padding="4,3">
                                                <StackPanel Orientation="Horizontal">
                                                    <!-- Spacing for tree indentation (checkbox + expander) -->
                                                    <TextBlock Width="60" Text="Name" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left" Margin="0,0,0,0"/>
                                                    <TextBlock Width="80" Text="Score" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left"/>
                                                    <TextBlock Width="120" Text="Group" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left"/>
                                                    <TextBlock Width="100" Text="Assert" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left"/>
                                                    <TextBlock Width="100" Text="Test" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left"/>
                                                    <TextBlock Width="80" Text="Jira#" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"
                                                              HorizontalAlignment="Left"/>
                                                </StackPanel>
                                            </Border>
                                            
                                            <!-- TreeView Content -->
                                            <ScrollViewer Grid.Row="1" Background="{DynamicResource WindowBackgroundBrush}">
                                                <TreeView Name="HvpTreeView" Background="{DynamicResource WindowBackgroundBrush}" 
                                                         Foreground="{DynamicResource TextForegroundBrush}" 
                                                         BorderThickness="0" Margin="4"
                                                         ItemTemplate="{StaticResource HvpNodeTemplate}"
                                                         SelectedItemChanged="HvpTreeView_SelectedItemChanged">
                                                    <TreeView.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Header="Create _Jira" Click="ContextMenu_CreateJira_Click"/>
                                                            <MenuItem Header="Show _Jira" Click="ContextMenu_ShowJira_Click"/>
                                                            <Separator/>
                                                            <MenuItem Header="Add to _Waiver" Click="ContextMenu_AddToWaiver_Click"/>
                                                            <Separator/>
                                                            <MenuItem Header="Clear _Selection" Click="ContextMenu_ClearSelection_Click"/>
                                                        </ContextMenu>
                                                    </TreeView.ContextMenu>
                                                    <TreeView.ItemContainerStyle>
                                                        <Style TargetType="TreeViewItem">
                                                            <Setter Property="ToolTip">
                                                                <Setter.Value>
                                                                    <StackPanel>
                                                                        <TextBlock Text="{Binding Name}" FontWeight="Bold" Margin="0,0,0,4"/>
                                                                        <TextBlock Text="{Binding FullPath}" FontStyle="Italic" Margin="0,0,0,4"/>
                                                                        <TextBlock>
                                                                            <Run Text="Coverage: "/>
                                                                            <Run Text="{Binding CoveragePercentage, StringFormat=F1}" FontWeight="Bold"/>
                                                                            <Run Text="%"/>
                                                                        </TextBlock>
                                                                        <TextBlock>
                                                                            <Run Text="Lines: "/>
                                                                            <Run Text="{Binding LinesCovered}" FontWeight="Bold"/>
                                                                            <Run Text=" / "/>
                                                                            <Run Text="{Binding TotalLines}"/>
                                                                        </TextBlock>
                                                                        <TextBlock Text="{Binding GroupType}" FontStyle="Italic" Margin="0,4,0,0"/>
                                                                    </StackPanel>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </TreeView.ItemContainerStyle>
                                                    <!-- Empty state styling -->
                                                    <TreeView.Style>
                                                        <Style TargetType="TreeView">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=HasItems}" Value="False">
                                                                    <Setter Property="Template">
                                                                        <Setter.Value>
                                                                            <ControlTemplate TargetType="TreeView">
                                                                                <Border BorderBrush="{TemplateBinding BorderBrush}" 
                                                                                       BorderThickness="{TemplateBinding BorderThickness}" 
                                                                                       Background="{TemplateBinding Background}">
                                                                                    <TextBlock Text="📊 Load coverage data to view hierarchy" 
                                                                                              HorizontalAlignment="Center" 
                                                                                              VerticalAlignment="Center" 
                                                                                              FontStyle="Italic" 
                                                                                              Foreground="{DynamicResource TextForegroundBrush}" 
                                                                                              Opacity="0.6"/>
                                                                                </Border>
                                                                            </ControlTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TreeView.Style>
                                                </TreeView>
                                            </ScrollViewer>
                                        </Grid>
                                    </TabItem>
                                    
                                    <!-- Stats Tab -->
                                    <TabItem Header="Stats">
                                        <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                            
                                            <ScrollViewer Background="{DynamicResource WindowBackgroundBrush}">
                                                <TreeView Name="StatsTreeView" Background="{DynamicResource WindowBackgroundBrush}" 
                                                         Foreground="{DynamicResource TextForegroundBrush}" 
                                                         BorderThickness="0" Margin="4"
                                                         ItemTemplate="{StaticResource StatsNodeTemplate}"
                                                         SelectedItemChanged="StatsTreeView_SelectedItemChanged">
                                                    <TreeView.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Header="Create _Jira" Click="ContextMenu_CreateJira_Click"/>
                                                            <MenuItem Header="Show _Jira" Click="ContextMenu_ShowJira_Click"/>
                                                            <Separator/>
                                                            <MenuItem Header="Add to _Waiver" Click="ContextMenu_AddToWaiver_Click"/>
                                                            <Separator/>
                                                            <MenuItem Header="Clear _Selection" Click="ContextMenu_ClearSelection_Click"/>
                                                        </ContextMenu>
                                                    </TreeView.ContextMenu>
                                                    <!-- Empty state styling -->
                                                    <TreeView.Style>
                                                        <Style TargetType="TreeView">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=HasItems}" Value="False">
                                                                    <Setter Property="Template">
                                                                        <Setter.Value>
                                                                            <ControlTemplate TargetType="TreeView">
                                                                                <Border BorderBrush="{TemplateBinding BorderBrush}" 
                                                                                       BorderThickness="{TemplateBinding BorderThickness}" 
                                                                                       Background="{TemplateBinding Background}">
                                                                                    <TextBlock Text="📈 Load coverage data to view statistics" 
                                                                                              HorizontalAlignment="Center" 
                                                                                              VerticalAlignment="Center" 
                                                                                              FontStyle="Italic" 
                                                                                              Foreground="{DynamicResource TextForegroundBrush}" 
                                                                                              Opacity="0.6"/>
                                                                                </Border>
                                                                            </ControlTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TreeView.Style>
                                                </TreeView>
                                            </ScrollViewer>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </avalonDock:LayoutAnchorable>
                        </avalonDock:LayoutAnchorablePane>
                    </avalonDock:LayoutAnchorablePaneGroup>
                    
                    <!-- Center Document Area -->
                    <avalonDock:LayoutDocumentPaneGroup>
                        <avalonDock:LayoutDocumentPane>
                            <avalonDock:LayoutDocument ContentId="HvpBrowser" Title="🌐 HVP Browser" CanClose="False">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                    <!-- Browser toolbar -->
                    <Border Grid.Row="0" Background="{DynamicResource ControlBackgroundBrush}" 
                            BorderBrush="{DynamicResource BorderBrush}" 
                            BorderThickness="0,0,0,1" Padding="10,5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Name="BackButton" Content="◀️" ToolTip="Back"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,3,0" IsEnabled="False" 
                                    Click="BackButton_Click"/>
                            <Button Grid.Column="1" Name="ForwardButton" Content="▶️" ToolTip="Forward"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,3,0" IsEnabled="False" 
                                    Click="ForwardButton_Click"/>
                            <Button Grid.Column="2" Name="RefreshButton" Content="🔄" ToolTip="Refresh"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,10,0" 
                                    Click="RefreshButton_Click"/>
                            <Separator Grid.Column="3" Margin="0,0,10,0"/>
                            <TextBlock Grid.Column="4" Text="🌐 HVP Report Browser" VerticalAlignment="Center" 
                                       FontWeight="Bold" Margin="0,0,10,0" 
                                       Foreground="{DynamicResource TextForegroundBrush}"/>
                            <TextBox Grid.Column="5" Name="HvpAddressBar" Margin="0,0,5,0" 
                                     VerticalAlignment="Center" IsReadOnly="True"
                                     Background="{DynamicResource WindowBackgroundBrush}"
                                     BorderBrush="{DynamicResource BorderBrush}"
                                     Foreground="{DynamicResource TextForegroundBrush}"/>
                        </Grid>
                    </Border>                                    <!-- WebView2 Browser -->
                                    <wv2:WebView2 Grid.Row="1" Name="HvpBrowser" Source="about:blank" Margin="2"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                            
                            <avalonDock:LayoutDocument ContentId="JiraBrowser" Title="🎫 Jira Browser" CanClose="False">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                    <!-- Jira Browser toolbar -->
                    <Border Grid.Row="0" Background="{DynamicResource ControlBackgroundBrush}" 
                            BorderBrush="{DynamicResource BorderBrush}" 
                            BorderThickness="0,0,0,1" Padding="10,5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Name="JiraBackButton" Content="◀️" ToolTip="Back"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,3,0" IsEnabled="False" 
                                    Click="JiraBackButton_Click"/>
                            <Button Grid.Column="1" Name="JiraForwardButton" Content="▶️" ToolTip="Forward"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,3,0" IsEnabled="False" 
                                    Click="JiraForwardButton_Click"/>
                            <Button Grid.Column="2" Name="JiraRefreshButton" Content="🔄" ToolTip="Refresh"
                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                    Margin="0,0,10,0" 
                                    Click="JiraRefreshButton_Click"/>
                            <Separator Grid.Column="3" Margin="0,0,10,0"/>
                            <TextBlock Grid.Column="4" Text="🎫 Jira Ticket" VerticalAlignment="Center" 
                                       FontWeight="Bold" Margin="0,0,10,0" 
                                       Foreground="{DynamicResource TextForegroundBrush}"/>
                            <TextBox Grid.Column="5" Name="JiraAddressBar" Margin="0,0,5,0" 
                                     VerticalAlignment="Center" IsReadOnly="True"
                                     Background="{DynamicResource WindowBackgroundBrush}"
                                     BorderBrush="{DynamicResource BorderBrush}"
                                     Foreground="{DynamicResource TextForegroundBrush}"/>
                        </Grid>
                    </Border>                                    <!-- WebView2 Browser for Jira -->
                                    <wv2:WebView2 Grid.Row="1" Name="JiraBrowser" Source="about:blank" Margin="2"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                            
                            <avalonDock:LayoutDocument ContentId="ModuleAnalysis" Title="Module Analysis" CanClose="True">
                                <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBlock Text="Module analysis view will be implemented here" 
                                              HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" 
                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                            
                            <avalonDock:LayoutDocument ContentId="TestResults" Title="Test Results" CanClose="True">
                                <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBlock Text="Test results view will be implemented here" 
                                              HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" 
                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                        </avalonDock:LayoutDocumentPane>
                    </avalonDock:LayoutDocumentPaneGroup>
                    
                    </avalonDock:LayoutPanel>
                    <!-- End of top horizontal section -->
                    
                    <!-- Output Panel as a docked panel (not overlay) -->
                    <avalonDock:LayoutAnchorablePaneGroup DockHeight="150" Orientation="Vertical">
                        <avalonDock:LayoutAnchorablePane>
                            <avalonDock:LayoutAnchorable ContentId="Output" Title="Output" CanHide="True" CanClose="False">
                                <ScrollViewer Name="OutputScrollViewer" 
                                              VerticalScrollBarVisibility="Auto" 
                                              HorizontalScrollBarVisibility="Auto"
                                              Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBox Name="OutputTextBox" 
                                             Text="Output will appear here..." 
                                             Padding="10" FontFamily="Consolas" FontSize="12"
                                             TextWrapping="Wrap" IsReadOnly="True"
                                             Background="{DynamicResource WindowBackgroundBrush}" 
                                             Foreground="{DynamicResource TextForegroundBrush}" 
                                             BorderThickness="0"/>
                                </ScrollViewer>
                            </avalonDock:LayoutAnchorable>
                        </avalonDock:LayoutAnchorablePane>
                    </avalonDock:LayoutAnchorablePaneGroup>
                    
                </avalonDock:LayoutPanel>
                
            </avalonDock:LayoutRoot>
        </avalonDock:DockingManager>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Height="25" 
                   Background="{DynamicResource ControlBackgroundBrush}"
                   BorderBrush="{DynamicResource BorderBrush}" 
                   BorderThickness="0,1,0,0">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Ready - Professional AvalonDock Interface" 
                           Foreground="{DynamicResource TextForegroundBrush}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <ProgressBar Name="OperationProgress" 
                             Width="150" Height="16" 
                             Visibility="Collapsed"/>
            </StatusBarItem>
        </StatusBar>
        
    </Grid>
</Window>