<Window x:Class="CoverageAnalyzerGUI.VSStyleMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CoverageAnalyzerGUI"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:avalonDock="http://schemas.xceed.com/wpf/xaml/avalondock"
        xmlns:avalondockthemes="clr-namespace:AvalonDock.Themes;assembly=AvalonDock.Themes.VS2013"
        mc:Ignorable="d"
        Title="Coverage Analyzer - Visual Studio Professional Style" Height="900" Width="1400">
    
    <Window.Resources>
        <!-- Light Theme Resources (Default) - Original Colors -->
        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ControlBackgroundBrush" Color="#F0F0F0"/>
        <SolidColorBrush x:Key="MenuBackgroundBrush" Color="#F6F6F6"/>
        <SolidColorBrush x:Key="TextForegroundBrush" Color="#000000"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E5E5E5"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#007ACC"/>
        <SolidColorBrush x:Key="ButtonBackgroundBrush" Color="#E1E1E1"/>
        <SolidColorBrush x:Key="ButtonHoverBrush" Color="#BEE6FD"/>
        <SolidColorBrush x:Key="ButtonPressedBrush" Color="#C4E5F6"/>
        <SolidColorBrush x:Key="TabBackgroundBrush" Color="#F6F6F6"/>
        <SolidColorBrush x:Key="TabSelectedBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="InputBackgroundBrush" Color="#FFFFFF"/>
        
        <!-- MenuItem Style for Better Contrast -->
        <Style x:Key="MenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TextForegroundBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Style.Triggers>
                <Trigger Property="IsHighlighted" Value="True">
                    <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
                <Trigger Property="IsSubmenuOpen" Value="True">
                    <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Button Style -->
        <Style x:Key="ToolbarButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ButtonBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource ButtonHoverBrush}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{DynamicResource ButtonPressedBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- TabItem Style with Better Contrast -->
        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Background" Value="{DynamicResource TabBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1,1,1,0"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Margin" Value="0,0,2,0"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{DynamicResource TabSelectedBrush}"/>
                    <Setter Property="BorderThickness" Value="1,1,1,0"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource ButtonHoverBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- TextBox Style -->
        <Style x:Key="InputTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource InputBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4"/>
        </Style>
    </Window.Resources>
    
    <!-- Visual Studio-Style Layout -->
    <Grid Background="{DynamicResource WindowBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Menu and Toolbar -->
            <RowDefinition Height="*"/>    <!-- Docking Area -->
            <RowDefinition Height="Auto"/> <!-- Status Bar -->
        </Grid.RowDefinitions>
        
        <!-- Top Area: Menu and Toolbar -->
        <StackPanel Grid.Row="0">
            <!-- Menu Bar -->
            <Menu Background="{DynamicResource MenuBackgroundBrush}" 
                  BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1" 
                  Foreground="{DynamicResource TextForegroundBrush}">
                <MenuItem Header="_File" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="_New Project..." Click="NewProject_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Open Project..." Click="OpenProject_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_Load Coverage Data" Click="LoadCoverageData_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_Save" Click="Save_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Save _All" Click="SaveAll_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="E_xit" Click="Exit_Click" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="_Edit" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="_Undo" Click="Undo_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Redo" Click="Redo_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="Cu_t" Click="Cut_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Copy" Click="Copy_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Paste" Click="Paste_Click" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="_View" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="_Solution Explorer" Click="ToggleSolutionExplorer_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Output" Click="ToggleOutput_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Error List" Click="ToggleErrorList_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_Reset Layout" Click="ResetLayout_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_Theme" Style="{StaticResource MenuItemStyle}">
                        <MenuItem Header="_Light Theme" Click="SetLightTheme_Click" Style="{StaticResource MenuItemStyle}"/>
                        <MenuItem Header="_Dark Theme" Click="SetDarkTheme_Click" Style="{StaticResource MenuItemStyle}"/>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="_Tools" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="_Coverage Analysis" Click="RunCoverageAnalysis_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="_Reload Project" Click="TestHvpTreeView_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_HTTP Authentication..." Click="HttpAuthentication_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="Create _Jira" Click="CreateJira_Click" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Add to _Waiver" Click="AddToWaiver_Click" Style="{StaticResource MenuItemStyle}"/>
                    <Separator/>
                    <MenuItem Header="_Options..." Click="Options_Click" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="_Help" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="_About" Click="About_Click" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
            </Menu>

            <!-- Toolbar -->
            <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                <ToolBarTray Background="{DynamicResource ControlBackgroundBrush}">
                <ToolBar Background="{DynamicResource ControlBackgroundBrush}" 
                         Foreground="{DynamicResource TextForegroundBrush}">
                    <Button Click="NewProject_Click" ToolTip="New Project" 
                            Content="ðŸ“„" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                    <Button Click="OpenProject_Click" ToolTip="Open Project" 
                            Content="ðŸ“" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                    <Button Click="Save_Click" ToolTip="Save" 
                            Content="ðŸ’¾" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                    <Separator/>
                    <Button Click="RunCoverageAnalysis_Click" ToolTip="Run Coverage Analysis" 
                            Content="â–¶ï¸" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                    <Separator/>
                    <Button Click="CreateJira_Click" ToolTip="Create Jira" 
                            Content="ðŸŽ«" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                    <Button Click="AddToWaiver_Click" ToolTip="Add to Waiver" 
                            Content="ðŸ“‹" Padding="6,4" FontSize="14" Width="32" Height="28"
                            Style="{StaticResource ToolbarButtonStyle}"/>
                </ToolBar>
            </ToolBarTray>
            </Border>
        </StackPanel>

        <!-- Main Docking Area - Visual Studio Style -->
        <avalonDock:DockingManager Grid.Row="1" Name="DockingManager" 
                                  Background="{DynamicResource WindowBackgroundBrush}"
                                  BorderBrush="{DynamicResource BorderBrush}"
                                  BorderThickness="1">
            
            <!-- Apply Visual Studio 2013 Theme -->
            <!--<avalonDock:DockingManager.Theme>
                <avalondockthemes:VS2013LightTheme />
            </avalonDock:DockingManager.Theme>-->
            
            <!-- Layout Root -->
            <avalonDock:LayoutRoot>
                <avalonDock:LayoutPanel Orientation="Horizontal">
                    
                    <!-- Left Dock Panel: Solution Explorer -->
                    <avalonDock:LayoutAnchorablePaneGroup DockWidth="300">
                        <avalonDock:LayoutAnchorablePane>
                            <avalonDock:LayoutAnchorable ContentId="SolutionExplorer" Title="Solution Explorer" 
                                                         CanHide="True" CanClose="False" CanFloat="True">
                                <!-- Solution Explorer Content -->
                                <TabControl Name="ExplorerTabControl" TabStripPlacement="Top" 
                                           Background="{DynamicResource ControlBackgroundBrush}" 
                                           BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                    
                                    <!-- HVP Tab -->
                                    <TabItem Header="Hvp" IsSelected="True" Style="{StaticResource TabItemStyle}">
                                        <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Column Headers -->
                                            <Border Grid.Row="0" Background="{DynamicResource MenuBackgroundBrush}" 
                                                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                                                <Grid MinWidth="250" Margin="38,0,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="50"/>
                                                        <ColumnDefinition Width="50"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <TextBlock Grid.Column="0" Text="Name" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                    <TextBlock Grid.Column="1" Text="Score" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                    <TextBlock Grid.Column="2" Text="Group" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                    <TextBlock Grid.Column="3" Text="Details" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                </Grid>
                                            </Border>
                                            
                                            <!-- TreeView Content -->
                                            <ScrollViewer Grid.Row="1" Background="{DynamicResource WindowBackgroundBrush}">
                                                <TreeView Name="HvpTreeView" Background="{DynamicResource WindowBackgroundBrush}" 
                                                         Foreground="{DynamicResource TextForegroundBrush}" 
                                                         BorderThickness="0" Margin="4">
                                                    <TreeViewItem Header="Load coverage data to view hierarchy" 
                                                                 Foreground="{DynamicResource TextForegroundBrush}"/>
                                                </TreeView>
                                            </ScrollViewer>
                                        </Grid>
                                    </TabItem>
                                    
                                    <!-- Stats Tab -->
                                    <TabItem Header="Stats" Style="{StaticResource TabItemStyle}">
                                        <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            
                                            <Border Grid.Row="0" Background="{DynamicResource MenuBackgroundBrush}" 
                                                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1" 
                                                    Padding="8,4">
                                                <StackPanel>
                                                    <TextBlock Text="Coverage Statistics" FontWeight="Bold" FontSize="11" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                    <TextBlock Name="ProjectInfoText" Text="" FontSize="10" Margin="0,2,0,0" 
                                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                                </StackPanel>
                                            </Border>
                                            
                                            <ScrollViewer Grid.Row="1" Background="{DynamicResource WindowBackgroundBrush}">
                                                <TreeView Name="StatsTreeView" Background="{DynamicResource WindowBackgroundBrush}" 
                                                         Foreground="{DynamicResource TextForegroundBrush}" 
                                                         BorderThickness="0" Margin="4">
                                                    <TreeViewItem Header="Load coverage data to view statistics" 
                                                                 Foreground="{DynamicResource TextForegroundBrush}"/>
                                                </TreeView>
                                            </ScrollViewer>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </avalonDock:LayoutAnchorable>
                        </avalonDock:LayoutAnchorablePane>
                    </avalonDock:LayoutAnchorablePaneGroup>
                    
                    <!-- Center Document Area -->
                    <avalonDock:LayoutDocumentPaneGroup>
                        <avalonDock:LayoutDocumentPane>
                            <avalonDock:LayoutDocument ContentId="HvpBrowser" Title="ðŸŒ HVP Browser" CanClose="False">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Browser toolbar -->
                                    <Border Grid.Row="0" Background="{DynamicResource ControlBackgroundBrush}" 
                                            BorderBrush="{DynamicResource BorderBrush}" 
                                            BorderThickness="0,0,0,1" Padding="10,5">
                                        <StackPanel Orientation="Horizontal">
                                            <Button Name="BackButton" Content="â—€ï¸" ToolTip="Back"
                                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                                    Margin="0,0,3,0" IsEnabled="False" 
                                                    Style="{StaticResource ToolbarButtonStyle}"/>
                                            <Button Name="ForwardButton" Content="â–¶ï¸" ToolTip="Forward"
                                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                                    Margin="0,0,3,0" IsEnabled="False" 
                                                    Style="{StaticResource ToolbarButtonStyle}"/>
                                            <Button Name="RefreshButton" Content="ðŸ”„" ToolTip="Refresh"
                                                    FontSize="14" Padding="6,4" Width="32" Height="28"
                                                    Margin="0,0,10,0" 
                                                    Style="{StaticResource ToolbarButtonStyle}"/>
                                            <Separator Margin="0,0,10,0"/>
                                            <TextBlock Text="ðŸŒ HVP Report Browser" VerticalAlignment="Center" 
                                                       FontWeight="Bold" Margin="0,0,10,0" 
                                                       Foreground="{DynamicResource TextForegroundBrush}"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- WebView2 Browser -->
                                    <wv2:WebView2 Grid.Row="1" Name="HvpBrowser" Source="about:blank" Margin="2"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                            
                            <avalonDock:LayoutDocument ContentId="ModuleAnalysis" Title="Module Analysis" CanClose="True">
                                <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBlock Text="Module analysis view will be implemented here" 
                                              HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" 
                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                            
                            <avalonDock:LayoutDocument ContentId="TestResults" Title="Test Results" CanClose="True">
                                <Grid Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBlock Text="Test results view will be implemented here" 
                                              HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" 
                                              Foreground="{DynamicResource TextForegroundBrush}"/>
                                </Grid>
                            </avalonDock:LayoutDocument>
                        </avalonDock:LayoutDocumentPane>
                    </avalonDock:LayoutDocumentPaneGroup>
                    
                </avalonDock:LayoutPanel>
                
                <!-- Bottom Anchorables -->
                <avalonDock:LayoutRoot.BottomSide>
                    <avalonDock:LayoutAnchorSide>
                        <avalonDock:LayoutAnchorGroup>
                            <avalonDock:LayoutAnchorable ContentId="Output" Title="Output" CanHide="True" CanClose="False">
                                <ScrollViewer Name="OutputScrollViewer" 
                                              VerticalScrollBarVisibility="Auto" 
                                              HorizontalScrollBarVisibility="Auto"
                                              Background="{DynamicResource WindowBackgroundBrush}">
                                    <TextBox Name="OutputTextBox" 
                                             Text="Output will appear here..." 
                                             Padding="10" FontFamily="Consolas" FontSize="12"
                                             TextWrapping="Wrap" IsReadOnly="True"
                                             Background="{DynamicResource WindowBackgroundBrush}" 
                                             Foreground="{DynamicResource TextForegroundBrush}" 
                                             BorderThickness="0"/>
                                </ScrollViewer>
                            </avalonDock:LayoutAnchorable>
                        </avalonDock:LayoutAnchorGroup>
                    </avalonDock:LayoutAnchorSide>
                </avalonDock:LayoutRoot.BottomSide>
                
            </avalonDock:LayoutRoot>
        </avalonDock:DockingManager>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Height="25" 
                   Background="{DynamicResource ControlBackgroundBrush}"
                   BorderBrush="{DynamicResource BorderBrush}" 
                   BorderThickness="0,1,0,0">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Ready - Visual Studio Style Interface" 
                           Foreground="{DynamicResource TextForegroundBrush}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <ProgressBar Name="OperationProgress" 
                             Width="150" Height="16" 
                             Visibility="Collapsed"/>
            </StatusBarItem>
        </StatusBar>
        
    </Grid>
</Window>